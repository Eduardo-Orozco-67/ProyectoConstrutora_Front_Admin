import{a}from"./axios-47b9d439.js";import{_ as u,a as c,b as h,c as f,d as s,e as i,j as v}from"./index-e9023bbb.js";const _={data(){return{formData:{servicio:"",descripcion:""},authToken:null}},created(){this.obtenerToken()},methods:{obtenerToken(){const o={username:"admin",password:"secretaacces123"};a.post("https://api-constructora.onrender.com/token",{username:o.username,password:o.password},{headers:{"Content-Type":"application/json"}}).then(e=>{console.log(e),this.authToken=e.data.access_token,a.defaults.headers.common.Authorization=`Bearer ${this.authToken}`}).catch(e=>{console.error("Error al obtener el token JWT",e),e.response&&console.error("Respuesta del servidor:",e.response.data)})},submitForm(){if(console.log("Submit button clicked"),this.validateFields()){const o=`https://api-constructora.onrender.com/servicio/create/?jsonwebtoken=${this.authToken}`;a.post(o,this.formData).then(e=>{e.status===200&&(this.showSuccessToast("¡Servicio creado exitosamente!"),this.limpiarCamposEntrada())}).catch(e=>{console.error("Error al crear el servicio",e),this.showApiErrorToast(e)})}},validateFields(){return this.formData.servicio&&this.formData.descripcion?!0:(this.showValidationError("Por favor, complete todos los campos."),!1)},showSuccessToast(o){this.$refs.toast.add({severity:"success",summary:"Éxito",detail:o,life:3e3})},showValidationError(o){this.$refs.toast.add({severity:"error",summary:"Error de validación",detail:o,life:5e3})},showApiErrorToast(o){let e="Error al procesar la solicitud";o.response&&(o.response.status===401?e="La empresa con ese nombre ya existe":e="Ya existe la empresa"),this.$refs.toast.add({severity:"error",summary:"Error",detail:e,life:5e3})},limpiarCamposEntrada(){this.formData.servicio="",this.formData.descripcion=""}}},b=s("h1",null,"Registro de Servicios",-1),T={class:"col-6 md:6"},E={class:"card p-fluid"},k={class:"field col-9 md:6"},w=s("label",{for:"servicio"},"Nombre del Servicio:",-1),D={class:"field col-9 md:6"},x=s("label",{for:"descripcion"},"Descripción del Servicio:",-1),y={class:"field col-3 md-3"};function S(o,e,d,V,r,n){const l=c("InputText"),m=c("Button"),p=c("Toast");return h(),f("div",null,[b,s("form",{onSubmit:e[2]||(e[2]=v((...t)=>n.submitForm&&n.submitForm(...t),["prevent"])),class:"grid"},[s("div",T,[s("div",E,[s("div",k,[w,i(l,{id:"servicio",type:"text",modelValue:r.formData.servicio,"onUpdate:modelValue":e[0]||(e[0]=t=>r.formData.servicio=t),placeholder:"Ejemplo: Servicio de Reparación",required:""},null,8,["modelValue"])]),s("div",D,[x,i(l,{id:"descripcion",modelValue:r.formData.descripcion,"onUpdate:modelValue":e[1]||(e[1]=t=>r.formData.descripcion=t),placeholder:"Ejemplo: Descripción detallada del servicio",rows:"4",required:""},null,8,["modelValue"])]),s("div",y,[i(m,{label:"Success",class:"p-button-success mr-2 mb-2",type:"submit"})])])])],32),i(p,{ref:"toast"},null,512)])}const C=u(_,[["render",S]]);export{C as default};
