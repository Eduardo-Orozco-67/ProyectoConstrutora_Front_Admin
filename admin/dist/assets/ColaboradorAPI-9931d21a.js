import{a as b}from"./axios-47b9d439.js";import{_ as E,a as d,b as g,c as v,d as e,e as a,w as u,g as w}from"./index-e9023bbb.js";const T={data(){return{colaboradores:[],eliminarDialogVisible:!1,editarDialogVisible:!1,telefono_colaborador:"",correo_colaborador:"",confirmacionColaborador:null,colaboradorEdit:{id_supervisor:null,nombre:"",cargo:"",telefono:"",correo:""},authToken:null}},created(){this.obtenerToken(),this.cargarColaboradores()},methods:{obtenerToken(){const r={username:"admin",password:"secretaacces123"};b.post("https://api-constructora.onrender.com/token",{username:r.username,password:r.password},{headers:{"Content-Type":"application/json"}}).then(o=>{this.authToken=o.data.access_token,b.defaults.headers.common.Authorization=`Bearer ${this.authToken}`,this.cargarColaboradores()}).catch(o=>{console.error("Error al obtener el token JWT",o),o.response&&console.error("Respuesta del servidor:",o.response.data)})},cargarColaboradores(){this.authToken&&b.get(`https://api-constructora.onrender.com/colaborador/ver-todos/?jsonwebtoken=${this.authToken}`).then(r=>{this.colaboradores=r.data}).catch(r=>{console.error("Error al obtener los datos de la API",r)})},confirmarEliminacionColaborador(r){this.eliminarDialogVisible=!0,this.confirmacionColaborador=r},eliminarColaborador(){if(this.confirmacionColaborador){const r=`https://api-constructora.onrender.com/colaborador/delete/${this.confirmacionColaborador.telefono}/${this.confirmacionColaborador.correo}?jsonwebtoken=${this.authToken}`;b.delete(r).then(o=>{o.status===200&&(this.cargarColaboradores(),this.showSuccessDeleteColaborador())}).catch(o=>{console.error("Error al eliminar el colaborador",o),this.showErrorDeleteColaborador()})}this.eliminarDialogVisible=!1},editarColaborador(r){this.colaboradorEdit={...r},this.editarDialogVisible=!0},guardarEdicionColaborador(){const r=`https://api-constructora.onrender.com/colaborador/update/${this.colaboradorEdit.telefono}/${this.colaboradorEdit.correo}?jsonwebtoken=${this.authToken}`;b.put(r,this.colaboradorEdit).then(o=>{o.status===200&&(this.cargarColaboradores(),this.showSuccessEditColaborador())}).catch(o=>{console.error("Error al editar el colaborador",o),this.showErrorEditColaborador()}),this.editarDialogVisible=!1},cancelarEdicionColaborador(){this.editarDialogVisible=!1,this.colaboradorEdit={id_supervisor:null,nombre:"",cargo:"",telefono:"",correo:""}},cancelarEliminacionColaborador(){this.eliminarDialogVisible=!1,this.confirmacionColaborador=null},buscarColaboradorPorTelefonoYCorreo(){if(this.telefono_colaborador||this.correo_colaborador){const r=`https://api-constructora.onrender.com/colaborador/ver1/${this.telefono_colaborador}/${this.correo_colaborador}?jsonwebtoken=${this.authToken}`;b.get(r).then(o=>{this.colaboradores=[o.data],this.showSuccessToastColaborador("Colaborador encontrado!","Colaborador encontrado con éxito.","success")}).catch(o=>{console.error("Error al buscar Colaborador",o),this.showErrorToastColaborador("Error","No se pudo encontrar el Colaborador.","error")})}else this.showWarnToastColaborador("Complete los campos de busqueda","verifique los campos de entrada.","warn")},showSuccessToastColaborador(r){this.$refs.toast.add({severity:"success",summary:"Éxito",detail:r,life:3e3})},showErrorToastColaborador(r){this.$refs.toast.add({severity:"error",summary:"Error",detail:r,life:5e3})},showWarnToastColaborador(r){this.$refs.toast.add({severity:"warn",summary:"Aviso",detail:r,life:5e3})},showSuccessEditColaborador(){this.showSuccessToastColaborador("El colaborador ha sido editado con éxito.")},showErrorEditColaborador(){this.showErrorToastColaborador("No se pudo editar el colaborador.")},showSuccessDeleteColaborador(){this.showSuccessToastColaborador("El colaborador ha sido eliminado con éxito.")},showErrorDeleteColaborador(){this.showErrorToastColaborador("No se pudo eliminar el colaborador.")},mostrarNotificacion(r,o,h){this.$refs.toast.show({severity:h,summary:r,detail:o})}}},k={class:"p-grid"},V={class:"p-col-12"},y={class:"card"},D={class:"p-grid"},x={class:"p-col-12 p-md-8"},N={class:"p-grid"},S={class:"p-col-12"},j={class:"p-fluid"},B={class:"p-field"},P=e("label",{for:"edit-nombre"},"Nombre",-1),U=e("br",null,null,-1),I={class:"p-field"},A=e("label",{for:"edit-cargo"},"Cargo",-1),q=e("br",null,null,-1),W={class:"p-field"},H=e("label",{for:"edit-telefono"},"Teléfono",-1),Y=e("br",null,null,-1),z={class:"p-field"},G=e("label",{for:"edit-correo"},"Correo",-1),J=e("br",null,null,-1),L={class:"p-d-flex p-jc-end"},O=e("p",null,"¿Está seguro de que desea eliminar este colaborador?",-1),R={class:"p-d-flex p-jc-end"};function F(r,o,h,K,l,t){const n=d("InputText"),i=d("Button"),p=d("Panel"),c=d("Column"),C=d("DataTable"),m=d("Dialog"),f=d("Toast");return g(),v("div",null,[e("div",k,[e("div",V,[e("div",y,[a(p,{header:"Colaboradores registrados",style:{height:"100%"}},{default:u(()=>[e("div",D,[e("div",x,[a(n,{type:"text",placeholder:"Teléfono del Colaborador",modelValue:l.telefono_colaborador,"onUpdate:modelValue":o[0]||(o[0]=s=>l.telefono_colaborador=s)},null,8,["modelValue"]),a(n,{type:"text",placeholder:"Correo del Colaborador",modelValue:l.correo_colaborador,"onUpdate:modelValue":o[1]||(o[1]=s=>l.correo_colaborador=s)},null,8,["modelValue"]),a(i,{label:"Buscar",icon:"pi pi-search",onClick:t.buscarColaboradorPorTelefonoYCorreo},null,8,["onClick"])])])]),_:1}),a(C,{value:l.colaboradores,paginator:!0,rows:5,rowsPerPageOptions:[5,10,25],responsiveLayout:"scroll"},{default:u(()=>[a(c,{field:"id_supervisor",header:"ID supervisor",sortable:!0,style:{width:"25%"}}),a(c,{field:"nombre",header:"Nombre",sortable:!0,style:{width:"25%"}}),a(c,{field:"cargo",header:"Cargo",sortable:!0,style:{width:"25%"}}),a(c,{field:"telefono",header:"Teléfono",sortable:!0,style:{width:"25%"}}),a(c,{field:"correo",header:"Correo",sortable:!0,style:{width:"25%"}}),a(c,{style:{width:"150px"}},{header:u(()=>[w(" Editar/Eliminar ")]),body:u(s=>[a(i,{icon:"pi pi-pencil",class:"p-button-success p-mr-2",onClick:_=>t.editarColaborador(s.data)},null,8,["onClick"]),a(i,{icon:"pi pi-trash",class:"p-button-danger",onClick:_=>t.confirmarEliminacionColaborador(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])])]),a(m,{header:"Editar Colaborador",visible:l.editarDialogVisible,onHide:o[6]||(o[6]=s=>l.editarDialogVisible=!1)},{default:u(()=>[e("div",null,[e("div",N,[e("div",S,[e("div",j,[e("div",B,[P,a(n,{id:"edit-nombre",modelValue:l.colaboradorEdit.nombre,"onUpdate:modelValue":o[2]||(o[2]=s=>l.colaboradorEdit.nombre=s)},null,8,["modelValue"])]),U,e("div",I,[A,a(n,{id:"edit-cargo",modelValue:l.colaboradorEdit.cargo,"onUpdate:modelValue":o[3]||(o[3]=s=>l.colaboradorEdit.cargo=s)},null,8,["modelValue"])]),q,e("div",W,[H,a(n,{id:"edit-telefono",modelValue:l.colaboradorEdit.telefono,"onUpdate:modelValue":o[4]||(o[4]=s=>l.colaboradorEdit.telefono=s),readonly:""},null,8,["modelValue"])]),Y,e("div",z,[G,a(n,{id:"edit-correo",modelValue:l.colaboradorEdit.correo,"onUpdate:modelValue":o[5]||(o[5]=s=>l.colaboradorEdit.correo=s),readonly:""},null,8,["modelValue"])]),J])])]),e("div",L,[a(i,{label:"Cancelar",class:"p-button-text",onClick:t.cancelarEdicionColaborador},null,8,["onClick"]),a(i,{label:"Guardar",class:"p-button-success",onClick:t.guardarEdicionColaborador},null,8,["onClick"])])])]),_:1},8,["visible"]),a(m,{header:"Eliminar Colaborador",visible:l.eliminarDialogVisible,onHide:o[7]||(o[7]=s=>l.eliminarDialogVisible=!1)},{default:u(()=>[e("div",null,[O,e("div",R,[a(i,{label:"Cancelar",class:"p-button-text",onClick:t.cancelarEliminacionColaborador},null,8,["onClick"]),a(i,{label:"Eliminar",class:"p-button-danger",onClick:t.eliminarColaborador},null,8,["onClick"])])])]),_:1},8,["visible"]),a(f,{ref:"toast"},null,512)])}const X=E(T,[["render",F]]);export{X as default};
